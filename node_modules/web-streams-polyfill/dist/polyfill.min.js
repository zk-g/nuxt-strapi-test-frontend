!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).WebStreamsPolyfill={})}(this,(function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:function(e){return"Symbol("+e+")"};function r(){}var o="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0;function n(e){return"object"==typeof e&&null!==e||"function"==typeof e}var i=r,a=Promise,u=Promise.prototype.then,l=Promise.resolve.bind(a),s=Promise.reject.bind(a);function c(e){return new a(e)}function d(e){return l(e)}function f(e){return s(e)}function b(e,t,r){return u.call(e,t,r)}function p(e,t,r){b(b(e,t,r),void 0,i)}function h(e,t){p(e,t)}function m(e,t){p(e,void 0,t)}function _(e,t,r){return b(e,t,r)}function y(e){b(e,void 0,i)}var v=function(){var e=o&&o.queueMicrotask;if("function"==typeof e)return e;var t=d(void 0);return function(e){return b(t,e)}}();function g(e,t,r){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function S(e,t,r){try{return d(g(e,t,r))}catch(e){return f(e)}}var w=function(){function e(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}return Object.defineProperty(e.prototype,"length",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.push=function(e){var t=this._back,r=t;16383===t._elements.length&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size},e.prototype.shift=function(){var e=this._front,t=e,r=this._cursor,o=r+1,n=e._elements,i=n[r];return 16384===o&&(t=e._next,o=0),--this._size,this._cursor=o,e!==t&&(this._front=t),n[r]=void 0,i},e.prototype.forEach=function(e){for(var t=this._cursor,r=this._front,o=r._elements;!(t===o.length&&void 0===r._next||t===o.length&&(t=0,0===(o=(r=r._next)._elements).length));)e(o[t]),++t},e.prototype.peek=function(){var e=this._front,t=this._cursor;return e._elements[t]},e}();function R(e,t){e._ownerReadableStream=t,t._reader=e,"readable"===t._state?C(e):"closed"===t._state?function(e){C(e),W(e)}(e):E(e,t._storedError)}function T(e,t){return sr(e._ownerReadableStream,t)}function P(e){"readable"===e._ownerReadableStream._state?O(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(e,t){E(e,t)}(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function q(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function C(e){e._closedPromise=c((function(t,r){e._closedPromise_resolve=t,e._closedPromise_reject=r}))}function E(e,t){C(e),O(e,t)}function O(e,t){y(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function W(e){e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}var j=t("[[AbortSteps]]"),B=t("[[ErrorSteps]]"),k=t("[[CancelSteps]]"),A=t("[[PullSteps]]"),z=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},D=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function F(e,t){if(void 0!==e&&("object"!=typeof(r=e)&&"function"!=typeof r))throw new TypeError(t+" is not an object.");var r}function L(e,t){if("function"!=typeof e)throw new TypeError(t+" is not a function.")}function I(e,t){if(!function(e){return"object"==typeof e&&null!==e||"function"==typeof e}(e))throw new TypeError(t+" is not an object.")}function M(e,t,r){if(void 0===e)throw new TypeError("Parameter "+t+" is required in '"+r+"'.")}function Q(e,t,r){if(void 0===e)throw new TypeError(t+" is required in '"+r+"'.")}function Y(e){return Number(e)}function x(e){return 0===e?0:e}function N(e,t){var r=Number.MAX_SAFE_INTEGER,o=Number(e);if(o=x(o),!z(o))throw new TypeError(t+" is not a finite number");if((o=function(e){return x(D(e))}(o))<0||o>r)throw new TypeError(t+" is outside the accepted range of 0 to "+r+", inclusive");return z(o)&&0!==o?o:0}function H(e,t){if(!ur(e))throw new TypeError(t+" is not a ReadableStream.")}function V(e){return new $(e)}function U(e,t){e._reader._readRequests.push(t)}function G(e,t,r){var o=e._reader._readRequests.shift();r?o._closeSteps():o._chunkSteps(t)}function X(e){return e._reader._readRequests.length}function J(e){var t=e._reader;return void 0!==t&&!!ee(t)}var K,Z,$=function(){function ReadableStreamDefaultReader(e){if(M(e,1,"ReadableStreamDefaultReader"),H(e,"First parameter"),lr(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");R(this,e),this._readRequests=new w}return Object.defineProperty(ReadableStreamDefaultReader.prototype,"closed",{get:function(){return ee(this)?this._closedPromise:f(re("closed"))},enumerable:!1,configurable:!0}),ReadableStreamDefaultReader.prototype.cancel=function(e){return void 0===e&&(e=void 0),ee(this)?void 0===this._ownerReadableStream?f(q("cancel")):T(this,e):f(re("cancel"))},ReadableStreamDefaultReader.prototype.read=function(){if(!ee(this))return f(re("read"));if(void 0===this._ownerReadableStream)return f(q("read from"));var e,t,r=c((function(r,o){e=r,t=o}));return te(this,{_chunkSteps:function(t){return e({value:t,done:!1})},_closeSteps:function(){return e({value:void 0,done:!0})},_errorSteps:function(e){return t(e)}}),r},ReadableStreamDefaultReader.prototype.releaseLock=function(){if(!ee(this))throw re("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");P(this)}},ReadableStreamDefaultReader}();function ee(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")}function te(e,t){var r=e._ownerReadableStream;r._disturbed=!0,"closed"===r._state?t._closeSteps():"errored"===r._state?t._errorSteps(r._storedError):r._readableStreamController[A](t)}function re(e){return new TypeError("ReadableStreamDefaultReader.prototype."+e+" can only be used on a ReadableStreamDefaultReader")}Object.defineProperties($.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty($.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0}),"symbol"==typeof t.asyncIterator&&((K={})[t.asyncIterator]=function(){return this},Z=K,Object.defineProperty(Z,t.asyncIterator,{enumerable:!1}));var oe=function(){function e(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}return e.prototype.next=function(){var e=this,t=function(){return e._nextSteps()};return this._ongoingPromise=this._ongoingPromise?_(this._ongoingPromise,t,t):t(),this._ongoingPromise},e.prototype.return=function(e){var t=this,r=function(){return t._returnSteps(e)};return this._ongoingPromise?_(this._ongoingPromise,r,r):r()},e.prototype._nextSteps=function(){var e=this;if(this._isFinished)return Promise.resolve({value:void 0,done:!0});var t,r,o=this._reader;if(void 0===o._ownerReadableStream)return f(q("iterate"));var n=c((function(e,o){t=e,r=o}));return te(o,{_chunkSteps:function(r){e._ongoingPromise=void 0,v((function(){return t({value:r,done:!1})}))},_closeSteps:function(){e._ongoingPromise=void 0,e._isFinished=!0,P(o),t({value:void 0,done:!0})},_errorSteps:function(t){e._ongoingPromise=void 0,e._isFinished=!0,P(o),r(t)}}),n},e.prototype._returnSteps=function(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;var t=this._reader;if(void 0===t._ownerReadableStream)return f(q("finish iterating"));if(!this._preventCancel){var r=T(t,e);return P(t),_(r,(function(){return{value:e,done:!0}}))}return P(t),d({value:e,done:!0})},e}(),ne={next:function(){return ie(this)?this._asyncIteratorImpl.next():f(ae("next"))},return:function(e){return ie(this)?this._asyncIteratorImpl.return(e):f(ae("return"))}};function ie(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl")}function ae(e){return new TypeError("ReadableStreamAsyncIterator."+e+" can only be used on a ReadableSteamAsyncIterator")}void 0!==Z&&Object.setPrototypeOf(ne,Z);var ue=Number.isNaN||function(e){return e!=e};function le(e){return!!function(e){if("number"!=typeof e)return!1;if(ue(e))return!1;if(e<0)return!1;return!0}(e)&&e!==1/0}function se(e){var t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function ce(e,t,r){if(!le(r=Number(r)))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function de(e){e._queue=new w,e._queueTotalSize=0}function fe(e){return e.slice()}var be=function(){function ReadableStreamBYOBRequest(){throw new TypeError("Illegal constructor")}return Object.defineProperty(ReadableStreamBYOBRequest.prototype,"view",{get:function(){if(!me(this))throw Be("view");return this._view},enumerable:!1,configurable:!0}),ReadableStreamBYOBRequest.prototype.respond=function(e){if(!me(this))throw Be("respond");if(M(e,1,"respond"),e=N(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");this._view.buffer,function(e,t){if(!le(t=Number(t)))throw new RangeError("bytesWritten must be a finite");qe(e,t)}(this._associatedReadableByteStreamController,e)},ReadableStreamBYOBRequest.prototype.respondWithNewView=function(e){if(!me(this))throw Be("respondWithNewView");if(M(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");if(0===e.byteLength)throw new TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw new TypeError("chunk's buffer must have non-zero byteLength");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");!function(e,t){var r=e._pendingPullIntos.peek();if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.byteLength!==t.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");r.buffer=t.buffer,qe(e,t.byteLength)}(this._associatedReadableByteStreamController,e)},ReadableStreamBYOBRequest}();Object.defineProperties(be.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(be.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});var pe=function(){function ReadableByteStreamController(){throw new TypeError("Illegal constructor")}return Object.defineProperty(ReadableByteStreamController.prototype,"byobRequest",{get:function(){if(!he(this))throw ke("byobRequest");if(null===this._byobRequest&&this._pendingPullIntos.length>0){var e=this._pendingPullIntos.peek(),t=new Uint8Array(e.buffer,e.byteOffset+e.bytesFilled,e.byteLength-e.bytesFilled),r=Object.create(be.prototype);!function(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}(r,this,t),this._byobRequest=r}return this._byobRequest},enumerable:!1,configurable:!0}),Object.defineProperty(ReadableByteStreamController.prototype,"desiredSize",{get:function(){if(!he(this))throw ke("desiredSize");return We(this)},enumerable:!1,configurable:!0}),ReadableByteStreamController.prototype.close=function(){if(!he(this))throw ke("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var e=this._controlledReadableByteStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be closed");!function(e){var t=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==t._state)return;if(e._queueTotalSize>0)return void(e._closeRequested=!0);if(e._pendingPullIntos.length>0){if(e._pendingPullIntos.peek().bytesFilled>0){var r=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Oe(e,r),r}}Ee(e),cr(t)}(this)},ReadableByteStreamController.prototype.enqueue=function(e){if(!he(this))throw ke("enqueue");if(M(e,1,"enqueue"),!ArrayBuffer.isView(e))throw new TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw new TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");var t=this._controlledReadableByteStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be enqueued to");!function(e,t){var r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;var o=t.buffer,n=t.byteOffset,i=t.byteLength,a=o;if(J(r))if(0===X(r))ge(e,a,n,i);else{var u=new Uint8Array(a,n,i);G(r,u,!1)}else De(r)?(ge(e,a,n,i),Pe(e)):ge(e,a,n,i);_e(e)}(this,e)},ReadableByteStreamController.prototype.error=function(e){if(void 0===e&&(e=void 0),!he(this))throw ke("error");Oe(this,e)},ReadableByteStreamController.prototype[k]=function(e){this._pendingPullIntos.length>0&&(this._pendingPullIntos.peek().bytesFilled=0);de(this);var t=this._cancelAlgorithm(e);return Ee(this),t},ReadableByteStreamController.prototype[A]=function(e){var t=this._controlledReadableByteStream;if(this._queueTotalSize>0){var r=this._queue.shift();this._queueTotalSize-=r.byteLength,Re(this);var o=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);e._chunkSteps(o)}else{var n=this._autoAllocateChunkSize;if(void 0!==n){var i=void 0;try{i=new ArrayBuffer(n)}catch(t){return void e._errorSteps(t)}var a={buffer:i,byteOffset:0,byteLength:n,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(a)}U(t,e),_e(this)}},ReadableByteStreamController}();function he(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")}function me(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")}function _e(e){(function(e){var t=e._controlledReadableByteStream;if("readable"!==t._state)return!1;if(e._closeRequested)return!1;if(!e._started)return!1;if(J(t)&&X(t)>0)return!0;if(De(t)&&ze(t)>0)return!0;if(We(e)>0)return!0;return!1})(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,p(e._pullAlgorithm(),(function(){e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,_e(e))}),(function(t){Oe(e,t)}))))}function ye(e,t){var r=!1;"closed"===e._state&&(r=!0);var o=ve(t);"default"===t.readerType?G(e,o,r):function(e,t,r){var o=e._reader._readIntoRequests.shift();r?o._closeSteps(t):o._chunkSteps(t)}(e,o,r)}function ve(e){var t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function ge(e,t,r,o){e._queue.push({buffer:t,byteOffset:r,byteLength:o}),e._queueTotalSize+=o}function Se(e,t){var r=t.elementSize,o=t.bytesFilled-t.bytesFilled%r,n=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),i=t.bytesFilled+n,a=i-i%r,u=n,l=!1;a>o&&(u=a-t.bytesFilled,l=!0);for(var s,c,d,f,b,p=e._queue;u>0;){var h=p.peek(),m=Math.min(u,h.byteLength),_=t.byteOffset+t.bytesFilled;s=t.buffer,c=_,d=h.buffer,f=h.byteOffset,b=m,new Uint8Array(s).set(new Uint8Array(d,f,b),c),h.byteLength===m?p.shift():(h.byteOffset+=m,h.byteLength-=m),e._queueTotalSize-=m,we(e,m,t),u-=m}return l}function we(e,t,r){Te(e),r.bytesFilled+=t}function Re(e){0===e._queueTotalSize&&e._closeRequested?(Ee(e),cr(e._controlledReadableByteStream)):_e(e)}function Te(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function Pe(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;var t=e._pendingPullIntos.peek();Se(e,t)&&(Ce(e),ye(e._controlledReadableByteStream,t))}}function qe(e,t){var r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");!function(e,t){t.buffer=t.buffer;var r=e._controlledReadableByteStream;if(De(r))for(;ze(r)>0;){ye(r,Ce(e))}}(e,r)}else!function(e,t,r){if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range");if(we(e,t,r),!(r.bytesFilled<r.elementSize)){Ce(e);var o=r.bytesFilled%r.elementSize;if(o>0){var n=r.byteOffset+r.bytesFilled,i=r.buffer.slice(n-o,n);ge(e,i,0,i.byteLength)}r.buffer=r.buffer,r.bytesFilled-=o,ye(e._controlledReadableByteStream,r),Pe(e)}}(e,t,r);_e(e)}function Ce(e){var t=e._pendingPullIntos.shift();return Te(e),t}function Ee(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Oe(e,t){var r=e._controlledReadableByteStream;"readable"===r._state&&(!function(e){Te(e),e._pendingPullIntos=new w}(e),de(e),Ee(e),dr(r,t))}function We(e){var t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function je(e,t,r){var o=Object.create(pe.prototype),n=function(){},i=function(){return d(void 0)},a=function(){return d(void 0)};void 0!==t.start&&(n=function(){return t.start(o)}),void 0!==t.pull&&(i=function(){return t.pull(o)}),void 0!==t.cancel&&(a=function(e){return t.cancel(e)});var u=t.autoAllocateChunkSize;!function(e,t,r,o,n,i,a){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,de(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=i,t._pullAlgorithm=o,t._cancelAlgorithm=n,t._autoAllocateChunkSize=a,t._pendingPullIntos=new w,e._readableStreamController=t,p(d(r()),(function(){t._started=!0,_e(t)}),(function(e){Oe(t,e)}))}(e,o,n,i,a,r,u)}function Be(e){return new TypeError("ReadableStreamBYOBRequest.prototype."+e+" can only be used on a ReadableStreamBYOBRequest")}function ke(e){return new TypeError("ReadableByteStreamController.prototype."+e+" can only be used on a ReadableByteStreamController")}function Ae(e,t){e._reader._readIntoRequests.push(t)}function ze(e){return e._reader._readIntoRequests.length}function De(e){var t=e._reader;return void 0!==t&&!!Le(t)}Object.defineProperties(pe.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(pe.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});var Fe=function(){function ReadableStreamBYOBReader(e){if(M(e,1,"ReadableStreamBYOBReader"),H(e,"First parameter"),lr(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!he(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");R(this,e),this._readIntoRequests=new w}return Object.defineProperty(ReadableStreamBYOBReader.prototype,"closed",{get:function(){return Le(this)?this._closedPromise:f(Ie("closed"))},enumerable:!1,configurable:!0}),ReadableStreamBYOBReader.prototype.cancel=function(e){return void 0===e&&(e=void 0),Le(this)?void 0===this._ownerReadableStream?f(q("cancel")):T(this,e):f(Ie("cancel"))},ReadableStreamBYOBReader.prototype.read=function(e){if(!Le(this))return f(Ie("read"));if(!ArrayBuffer.isView(e))return f(new TypeError("view must be an array buffer view"));if(0===e.byteLength)return f(new TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return f(new TypeError("view's buffer must have non-zero byteLength"));if(void 0===this._ownerReadableStream)return f(q("read from"));var t,r,o=c((function(e,o){t=e,r=o}));return function(e,t,r){var o=e._ownerReadableStream;o._disturbed=!0,"errored"===o._state?r._errorSteps(o._storedError):function(e,t,r){var o=e._controlledReadableByteStream,n=1;t.constructor!==DataView&&(n=t.constructor.BYTES_PER_ELEMENT);var i=t.constructor,a={buffer:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:n,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(a),void Ae(o,r);if("closed"!==o._state){if(e._queueTotalSize>0){if(Se(e,a)){var u=ve(a);return Re(e),void r._chunkSteps(u)}if(e._closeRequested){var l=new TypeError("Insufficient bytes to fill elements in the given buffer");return Oe(e,l),void r._errorSteps(l)}}e._pendingPullIntos.push(a),Ae(o,r),_e(e)}else{var s=new i(a.buffer,a.byteOffset,0);r._closeSteps(s)}}(o._readableStreamController,t,r)}(this,e,{_chunkSteps:function(e){return t({value:e,done:!1})},_closeSteps:function(e){return t({value:e,done:!0})},_errorSteps:function(e){return r(e)}}),o},ReadableStreamBYOBReader.prototype.releaseLock=function(){if(!Le(this))throw Ie("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");P(this)}},ReadableStreamBYOBReader}();function Le(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")}function Ie(e){return new TypeError("ReadableStreamBYOBReader.prototype."+e+" can only be used on a ReadableStreamBYOBReader")}function Me(e,t){var r=e.highWaterMark;if(void 0===r)return t;if(ue(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Qe(e){var t=e.size;return t||function(){return 1}}function Ye(e,t){F(e,t);var r=null==e?void 0:e.highWaterMark,o=null==e?void 0:e.size;return{highWaterMark:void 0===r?void 0:Y(r),size:void 0===o?void 0:xe(o,t+" has member 'size' that")}}function xe(e,t){return L(e,t),function(t){return Y(e(t))}}function Ne(e,t,r){return L(e,r),function(r){return S(e,t,[r])}}function He(e,t,r){return L(e,r),function(){return S(e,t,[])}}function Ve(e,t,r){return L(e,r),function(r){return g(e,t,[r])}}function Ue(e,t,r){return L(e,r),function(r,o){return S(e,t,[r,o])}}function Ge(e,t){if(!Ze(e))throw new TypeError(t+" is not a WritableStream.")}Object.defineProperties(Fe.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Fe.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});var Xe=function(){function WritableStream(e,t){void 0===e&&(e={}),void 0===t&&(t={}),void 0===e?e=null:I(e,"First parameter");var r=Ye(t,"Second parameter"),o=function(e,t){F(e,t);var r=null==e?void 0:e.abort,o=null==e?void 0:e.close,n=null==e?void 0:e.start,i=null==e?void 0:e.type,a=null==e?void 0:e.write;return{abort:void 0===r?void 0:Ne(r,e,t+" has member 'abort' that"),close:void 0===o?void 0:He(o,e,t+" has member 'close' that"),start:void 0===n?void 0:Ve(n,e,t+" has member 'start' that"),write:void 0===a?void 0:Ue(a,e,t+" has member 'write' that"),type:i}}(e,"First parameter");if(Ke(this),void 0!==o.type)throw new RangeError("Invalid type is specified");var n=Qe(r);!function(e,t,r,o){var n=Object.create(mt.prototype),i=function(){},a=function(){return d(void 0)},u=function(){return d(void 0)},l=function(){return d(void 0)};void 0!==t.start&&(i=function(){return t.start(n)});void 0!==t.write&&(a=function(e){return t.write(e,n)});void 0!==t.close&&(u=function(){return t.close()});void 0!==t.abort&&(l=function(e){return t.abort(e)});_t(e,n,i,a,u,l,r,o)}(this,o,Me(r,1),n)}return Object.defineProperty(WritableStream.prototype,"locked",{get:function(){if(!Ze(this))throw Tt("locked");return $e(this)},enumerable:!1,configurable:!0}),WritableStream.prototype.abort=function(e){return void 0===e&&(e=void 0),Ze(this)?$e(this)?f(new TypeError("Cannot abort a stream that already has a writer")):et(this,e):f(Tt("abort"))},WritableStream.prototype.close=function(){return Ze(this)?$e(this)?f(new TypeError("Cannot close a stream that already has a writer")):it(this)?f(new TypeError("Cannot close an already-closing stream")):tt(this):f(Tt("close"))},WritableStream.prototype.getWriter=function(){if(!Ze(this))throw Tt("getWriter");return Je(this)},WritableStream}();function Je(e){return new lt(e)}function Ke(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new w,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function Ze(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")}function $e(e){return void 0!==e._writer}function et(e,t){var r=e._state;if("closed"===r||"errored"===r)return d(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;var o=!1;"erroring"===r&&(o=!0,t=void 0);var n=c((function(r,n){e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:n,_reason:t,_wasAlreadyErroring:o}}));return e._pendingAbortRequest._promise=n,o||ot(e,t),n}function tt(e){var t=e._state;if("closed"===t||"errored"===t)return f(new TypeError("The stream (in "+t+" state) is not in the writable state and cannot be closed"));var r,o=c((function(t,r){var o={_resolve:t,_reject:r};e._closeRequest=o})),n=e._writer;return void 0!==n&&e._backpressure&&"writable"===t&&zt(n),ce(r=e._writableStreamController,ht,0),gt(r),o}function rt(e,t){"writable"!==e._state?nt(e):ot(e,t)}function ot(e,t){var r=e._writableStreamController;e._state="erroring",e._storedError=t;var o=e._writer;void 0!==o&&ft(o,t),!function(e){if(void 0===e._inFlightWriteRequest&&void 0===e._inFlightCloseRequest)return!1;return!0}(e)&&r._started&&nt(e)}function nt(e){e._state="errored",e._writableStreamController[B]();var t=e._storedError;if(e._writeRequests.forEach((function(e){e._reject(t)})),e._writeRequests=new w,void 0!==e._pendingAbortRequest){var r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void at(e);p(e._writableStreamController[j](r._reason),(function(){r._resolve(),at(e)}),(function(t){r._reject(t),at(e)}))}else at(e)}function it(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function at(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);var t=e._writer;void 0!==t&&Ot(t,e._storedError)}function ut(e,t){var r=e._writer;void 0!==r&&t!==e._backpressure&&(t?function(e){jt(e)}(r):zt(r)),e._backpressure=t}Object.defineProperties(Xe.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Xe.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});var lt=function(){function WritableStreamDefaultWriter(e){if(M(e,1,"WritableStreamDefaultWriter"),Ge(e,"First parameter"),$e(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;var t,r=e._state;if("writable"===r)!it(e)&&e._backpressure?jt(this):kt(this),Ct(this);else if("erroring"===r)Bt(this,e._storedError),Ct(this);else if("closed"===r)kt(this),Ct(t=this),Wt(t);else{var o=e._storedError;Bt(this,o),Et(this,o)}}return Object.defineProperty(WritableStreamDefaultWriter.prototype,"closed",{get:function(){return st(this)?this._closedPromise:f(Pt("closed"))},enumerable:!1,configurable:!0}),Object.defineProperty(WritableStreamDefaultWriter.prototype,"desiredSize",{get:function(){if(!st(this))throw Pt("desiredSize");if(void 0===this._ownerWritableStream)throw qt("desiredSize");return function(e){var t=e._ownerWritableStream,r=t._state;if("errored"===r||"erroring"===r)return null;if("closed"===r)return 0;return vt(t._writableStreamController)}(this)},enumerable:!1,configurable:!0}),Object.defineProperty(WritableStreamDefaultWriter.prototype,"ready",{get:function(){return st(this)?this._readyPromise:f(Pt("ready"))},enumerable:!1,configurable:!0}),WritableStreamDefaultWriter.prototype.abort=function(e){return void 0===e&&(e=void 0),st(this)?void 0===this._ownerWritableStream?f(qt("abort")):function(e,t){return et(e._ownerWritableStream,t)}(this,e):f(Pt("abort"))},WritableStreamDefaultWriter.prototype.close=function(){if(!st(this))return f(Pt("close"));var e=this._ownerWritableStream;return void 0===e?f(qt("close")):it(e)?f(new TypeError("Cannot close an already-closing stream")):ct(this)},WritableStreamDefaultWriter.prototype.releaseLock=function(){if(!st(this))throw Pt("releaseLock");void 0!==this._ownerWritableStream&&bt(this)},WritableStreamDefaultWriter.prototype.write=function(e){return void 0===e&&(e=void 0),st(this)?void 0===this._ownerWritableStream?f(qt("write to")):pt(this,e):f(Pt("write"))},WritableStreamDefaultWriter}();function st(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")}function ct(e){return tt(e._ownerWritableStream)}function dt(e,t){"pending"===e._closedPromiseState?Ot(e,t):function(e,t){Et(e,t)}(e,t)}function ft(e,t){"pending"===e._readyPromiseState?At(e,t):function(e,t){Bt(e,t)}(e,t)}function bt(e){var t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");ft(e,r),dt(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function pt(e,t){var r=e._ownerWritableStream,o=r._writableStreamController,n=function(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return St(e,t),1}}(o,t);if(r!==e._ownerWritableStream)return f(qt("write to"));var i=r._state;if("errored"===i)return f(r._storedError);if(it(r)||"closed"===i)return f(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===i)return f(r._storedError);var a=function(e){return c((function(t,r){var o={_resolve:t,_reject:r};e._writeRequests.push(o)}))}(r);return function(e,t,r){try{ce(e,t,r)}catch(t){return void St(e,t)}var o=e._controlledWritableStream;if(!it(o)&&"writable"===o._state){var n=wt(e);ut(o,n)}gt(e)}(o,t,n),a}Object.defineProperties(lt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(lt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});var ht={},mt=function(){function WritableStreamDefaultController(){throw new TypeError("Illegal constructor")}return WritableStreamDefaultController.prototype.error=function(e){if(void 0===e&&(e=void 0),!function(e){if(!n(e))return!1;if(!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream"))return!1;return!0}(this))throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");"writable"===this._controlledWritableStream._state&&Rt(this,e)},WritableStreamDefaultController.prototype[j]=function(e){var t=this._abortAlgorithm(e);return yt(this),t},WritableStreamDefaultController.prototype[B]=function(){de(this)},WritableStreamDefaultController}();function _t(e,t,r,o,n,i,a,u){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,de(t),t._started=!1,t._strategySizeAlgorithm=u,t._strategyHWM=a,t._writeAlgorithm=o,t._closeAlgorithm=n,t._abortAlgorithm=i;var l=wt(t);ut(e,l),p(d(r()),(function(){t._started=!0,gt(t)}),(function(r){t._started=!0,rt(e,r)}))}function yt(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function vt(e){return e._strategyHWM-e._queueTotalSize}function gt(e){var t=e._controlledWritableStream;if(e._started&&void 0===t._inFlightWriteRequest)if("erroring"!==t._state){if(0!==e._queue.length){var r=e._queue.peek().value;r===ht?function(e){var t=e._controlledWritableStream;(function(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0})(t),se(e);var r=e._closeAlgorithm();yt(e),p(r,(function(){!function(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";var t=e._writer;void 0!==t&&Wt(t)}(t)}),(function(e){!function(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),rt(e,t)}(t,e)}))}(e):function(e,t){var r=e._controlledWritableStream;(function(e){e._inFlightWriteRequest=e._writeRequests.shift()})(r),p(e._writeAlgorithm(t),(function(){!function(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}(r);var t=r._state;if(se(e),!it(r)&&"writable"===t){var o=wt(e);ut(r,o)}gt(e)}),(function(t){"writable"===r._state&&yt(e),function(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,rt(e,t)}(r,t)}))}(e,r)}}else nt(t)}function St(e,t){"writable"===e._controlledWritableStream._state&&Rt(e,t)}function wt(e){return vt(e)<=0}function Rt(e,t){var r=e._controlledWritableStream;yt(e),ot(r,t)}function Tt(e){return new TypeError("WritableStream.prototype."+e+" can only be used on a WritableStream")}function Pt(e){return new TypeError("WritableStreamDefaultWriter.prototype."+e+" can only be used on a WritableStreamDefaultWriter")}function qt(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Ct(e){e._closedPromise=c((function(t,r){e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"}))}function Et(e,t){Ct(e),Ot(e,t)}function Ot(e,t){y(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}function Wt(e){e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}function jt(e){e._readyPromise=c((function(t,r){e._readyPromise_resolve=t,e._readyPromise_reject=r})),e._readyPromiseState="pending"}function Bt(e,t){jt(e),At(e,t)}function kt(e){jt(e),zt(e)}function At(e,t){y(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}function zt(e){e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}Object.defineProperties(mt.prototype,{error:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(mt.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});var Dt="undefined"!=typeof DOMException?DOMException:void 0;var Ft,Lt=function(e){if("function"!=typeof e&&"object"!=typeof e)return!1;try{return new e,!0}catch(e){return!1}}(Dt)?Dt:((Ft=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}).prototype=Object.create(Error.prototype),Object.defineProperty(Ft.prototype,"constructor",{value:Ft,writable:!0,configurable:!0}),Ft);function It(e,t,o,n,i,a){var u=V(e),l=Je(t);e._disturbed=!0;var s=!1,_=d(void 0);return c((function(v,g){var S,w,R,T;if(void 0!==a){if(S=function(){var r=new Lt("Aborted","AbortError"),o=[];n||o.push((function(){return"writable"===t._state?et(t,r):d(void 0)})),i||o.push((function(){return"readable"===e._state?sr(e,r):d(void 0)})),O((function(){return Promise.all(o.map((function(e){return e()})))}),!0,r)},a.aborted)return void S();a.addEventListener("abort",S)}if(E(e,u._closedPromise,(function(e){n?W(!0,e):O((function(){return et(t,e)}),!0,e)})),E(t,l._closedPromise,(function(t){i?W(!0,t):O((function(){return sr(e,t)}),!0,t)})),w=e,R=u._closedPromise,T=function(){o?W():O((function(){return function(e){var t=e._ownerWritableStream,r=t._state;return it(t)||"closed"===r?d(void 0):"errored"===r?f(t._storedError):ct(e)}(l)}))},"closed"===w._state?T():h(R,T),it(t)||"closed"===t._state){var q=new TypeError("the destination writable stream closed before all data could be piped to it");i?W(!0,q):O((function(){return sr(e,q)}),!0,q)}function C(){var e=_;return b(_,(function(){return e!==_?C():void 0}))}function E(e,t,r){"errored"===e._state?r(e._storedError):m(t,r)}function O(e,r,o){function n(){p(e(),(function(){return j(r,o)}),(function(e){return j(!0,e)}))}s||(s=!0,"writable"!==t._state||it(t)?n():h(C(),n))}function W(e,r){s||(s=!0,"writable"!==t._state||it(t)?j(e,r):h(C(),(function(){return j(e,r)})))}function j(e,t){bt(l),P(u),void 0!==a&&a.removeEventListener("abort",S),e?g(t):v(void 0)}y(c((function(e,t){!function o(n){n?e():b(s?d(!0):b(l._readyPromise,(function(){return c((function(e,t){te(u,{_chunkSteps:function(t){_=b(pt(l,t),void 0,r),e(!1)},_closeSteps:function(){return e(!0)},_errorSteps:t})}))})),o,t)}(!1)})))}))}var Mt=function(){function ReadableStreamDefaultController(){throw new TypeError("Illegal constructor")}return Object.defineProperty(ReadableStreamDefaultController.prototype,"desiredSize",{get:function(){if(!Qt(this))throw Kt("desiredSize");return Gt(this)},enumerable:!1,configurable:!0}),ReadableStreamDefaultController.prototype.close=function(){if(!Qt(this))throw Kt("close");if(!Xt(this))throw new TypeError("The stream is not in a state that permits close");Ht(this)},ReadableStreamDefaultController.prototype.enqueue=function(e){if(void 0===e&&(e=void 0),!Qt(this))throw Kt("enqueue");if(!Xt(this))throw new TypeError("The stream is not in a state that permits enqueue");return Vt(this,e)},ReadableStreamDefaultController.prototype.error=function(e){if(void 0===e&&(e=void 0),!Qt(this))throw Kt("error");Ut(this,e)},ReadableStreamDefaultController.prototype[k]=function(e){de(this);var t=this._cancelAlgorithm(e);return Nt(this),t},ReadableStreamDefaultController.prototype[A]=function(e){var t=this._controlledReadableStream;if(this._queue.length>0){var r=se(this);this._closeRequested&&0===this._queue.length?(Nt(this),cr(t)):Yt(this),e._chunkSteps(r)}else U(t,e),Yt(this)},ReadableStreamDefaultController}();function Qt(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")}function Yt(e){xt(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,p(e._pullAlgorithm(),(function(){e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Yt(e))}),(function(t){Ut(e,t)}))))}function xt(e){var t=e._controlledReadableStream;return!!Xt(e)&&(!!e._started&&(!!(lr(t)&&X(t)>0)||Gt(e)>0))}function Nt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Ht(e){if(Xt(e)){var t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(Nt(e),cr(t))}}function Vt(e,t){if(Xt(e)){var r=e._controlledReadableStream;if(lr(r)&&X(r)>0)G(r,t,!1);else{var o=void 0;try{o=e._strategySizeAlgorithm(t)}catch(t){throw Ut(e,t),t}try{ce(e,t,o)}catch(t){throw Ut(e,t),t}}Yt(e)}}function Ut(e,t){var r=e._controlledReadableStream;"readable"===r._state&&(de(e),Nt(e),dr(r,t))}function Gt(e){var t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Xt(e){var t=e._controlledReadableStream._state;return!e._closeRequested&&"readable"===t}function Jt(e,t,r,o,n,i,a){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,de(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=a,t._strategyHWM=i,t._pullAlgorithm=o,t._cancelAlgorithm=n,e._readableStreamController=t,p(d(r()),(function(){t._started=!0,Yt(t)}),(function(e){Ut(t,e)}))}function Kt(e){return new TypeError("ReadableStreamDefaultController.prototype."+e+" can only be used on a ReadableStreamDefaultController")}function Zt(e,t,r){return L(e,r),function(r){return S(e,t,[r])}}function $t(e,t,r){return L(e,r),function(r){return S(e,t,[r])}}function er(e,t,r){return L(e,r),function(r){return g(e,t,[r])}}function tr(e,t){if("bytes"!==(e=""+e))throw new TypeError(t+" '"+e+"' is not a valid enumeration value for ReadableStreamType");return e}function rr(e,t){if("byob"!==(e=""+e))throw new TypeError(t+" '"+e+"' is not a valid enumeration value for ReadableStreamReaderMode");return e}function or(e,t){F(e,t);var r=null==e?void 0:e.preventAbort,o=null==e?void 0:e.preventCancel,n=null==e?void 0:e.preventClose,i=null==e?void 0:e.signal;return void 0!==i&&function(e,t){if(!function(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}(e))throw new TypeError(t+" is not an AbortSignal.")}(i,t+" has member 'signal' that"),{preventAbort:Boolean(r),preventCancel:Boolean(o),preventClose:Boolean(n),signal:i}}Object.defineProperties(Mt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Mt.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});var nr=function(){function ReadableStream(e,t){void 0===e&&(e={}),void 0===t&&(t={}),void 0===e?e=null:I(e,"First parameter");var r=Ye(t,"Second parameter"),o=function(e,t){F(e,t);var r=e,o=null==r?void 0:r.autoAllocateChunkSize,n=null==r?void 0:r.cancel,i=null==r?void 0:r.pull,a=null==r?void 0:r.start,u=null==r?void 0:r.type;return{autoAllocateChunkSize:void 0===o?void 0:N(o,t+" has member 'autoAllocateChunkSize' that"),cancel:void 0===n?void 0:Zt(n,r,t+" has member 'cancel' that"),pull:void 0===i?void 0:$t(i,r,t+" has member 'pull' that"),start:void 0===a?void 0:er(a,r,t+" has member 'start' that"),type:void 0===u?void 0:tr(u,t+" has member 'type' that")}}(e,"First parameter");if(ar(this),"bytes"===o.type){if(void 0!==r.size)throw new RangeError("The strategy for a byte stream cannot have a size function");je(this,o,Me(r,0))}else{var n=Qe(r);!function(e,t,r,o){var n=Object.create(Mt.prototype),i=function(){},a=function(){return d(void 0)},u=function(){return d(void 0)};void 0!==t.start&&(i=function(){return t.start(n)}),void 0!==t.pull&&(a=function(){return t.pull(n)}),void 0!==t.cancel&&(u=function(e){return t.cancel(e)}),Jt(e,n,i,a,u,r,o)}(this,o,Me(r,1),n)}}return Object.defineProperty(ReadableStream.prototype,"locked",{get:function(){if(!ur(this))throw fr("locked");return lr(this)},enumerable:!1,configurable:!0}),ReadableStream.prototype.cancel=function(e){return void 0===e&&(e=void 0),ur(this)?lr(this)?f(new TypeError("Cannot cancel a stream that already has a reader")):sr(this,e):f(fr("cancel"))},ReadableStream.prototype.getReader=function(e){if(void 0===e&&(e=void 0),!ur(this))throw fr("getReader");return void 0===function(e,t){F(e,t);var r=null==e?void 0:e.mode;return{mode:void 0===r?void 0:rr(r,t+" has member 'mode' that")}}(e,"First parameter").mode?V(this):new Fe(this)},ReadableStream.prototype.pipeThrough=function(e,t){if(void 0===t&&(t={}),!ur(this))throw fr("pipeThrough");M(e,1,"pipeThrough");var r=function(e,t){F(e,t);var r=null==e?void 0:e.readable;Q(r,"readable","ReadableWritablePair"),H(r,t+" has member 'readable' that");var o=null==e?void 0:e.writable;return Q(o,"writable","ReadableWritablePair"),Ge(o,t+" has member 'writable' that"),{readable:r,writable:o}}(e,"First parameter"),o=or(t,"Second parameter");if(lr(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if($e(r.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return y(It(this,r.writable,o.preventClose,o.preventAbort,o.preventCancel,o.signal)),r.readable},ReadableStream.prototype.pipeTo=function(e,t){if(void 0===t&&(t={}),!ur(this))return f(fr("pipeTo"));if(void 0===e)return f("Parameter 1 is required in 'pipeTo'.");if(!Ze(e))return f(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));var r;try{r=or(t,"Second parameter")}catch(e){return f(e)}return lr(this)?f(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):$e(e)?f(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):It(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)},ReadableStream.prototype.tee=function(){if(!ur(this))throw fr("tee");var e=function(e,t){var r,o,n,i,a,u=V(e),l=!1,s=!1,f=!1,b=c((function(e){a=e}));function p(){return l||(l=!0,te(u,{_chunkSteps:function(e){v((function(){l=!1;var t=e,r=e;s||Vt(n._readableStreamController,t),f||Vt(i._readableStreamController,r)}))},_closeSteps:function(){l=!1,s||Ht(n._readableStreamController),f||Ht(i._readableStreamController)},_errorSteps:function(){l=!1}})),d(void 0)}function h(){}return n=ir(h,p,(function(t){if(s=!0,r=t,f){var n=fe([r,o]),i=sr(e,n);a(i)}return b})),i=ir(h,p,(function(t){if(f=!0,o=t,s){var n=fe([r,o]),i=sr(e,n);a(i)}return b})),m(u._closedPromise,(function(e){Ut(n._readableStreamController,e),Ut(i._readableStreamController,e)})),[n,i]}(this);return fe(e)},ReadableStream.prototype.values=function(e){if(void 0===e&&(e=void 0),!ur(this))throw fr("values");var t,r,o,n,i,a=function(e,t){F(e,t);var r=null==e?void 0:e.preventCancel;return{preventCancel:Boolean(r)}}(e,"First parameter");return t=this,r=a.preventCancel,o=V(t),n=new oe(o,r),(i=Object.create(ne))._asyncIteratorImpl=n,i},ReadableStream}();function ir(e,t,r,o,n){void 0===o&&(o=1),void 0===n&&(n=function(){return 1});var i=Object.create(nr.prototype);return ar(i),Jt(i,Object.create(Mt.prototype),e,t,r,o,n),i}function ar(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function ur(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")}function lr(e){return void 0!==e._reader}function sr(e,t){return e._disturbed=!0,"closed"===e._state?d(void 0):"errored"===e._state?f(e._storedError):(cr(e),_(e._readableStreamController[k](t),r))}function cr(e){e._state="closed";var t=e._reader;void 0!==t&&(ee(t)&&(t._readRequests.forEach((function(e){e._closeSteps()})),t._readRequests=new w),W(t))}function dr(e,t){e._state="errored",e._storedError=t;var r=e._reader;void 0!==r&&(ee(r)?(r._readRequests.forEach((function(e){e._errorSteps(t)})),r._readRequests=new w):(r._readIntoRequests.forEach((function(e){e._errorSteps(t)})),r._readIntoRequests=new w),O(r,t))}function fr(e){return new TypeError("ReadableStream.prototype."+e+" can only be used on a ReadableStream")}function br(e,t){F(e,t);var r=null==e?void 0:e.highWaterMark;return Q(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Y(r)}}Object.defineProperties(nr.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(nr.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"==typeof t.asyncIterator&&Object.defineProperty(nr.prototype,t.asyncIterator,{value:nr.prototype.values,writable:!0,configurable:!0});var pr=function size(e){return e.byteLength},hr=function(){function ByteLengthQueuingStrategy(e){M(e,1,"ByteLengthQueuingStrategy"),e=br(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}return Object.defineProperty(ByteLengthQueuingStrategy.prototype,"highWaterMark",{get:function(){if(!_r(this))throw mr("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark},enumerable:!1,configurable:!0}),Object.defineProperty(ByteLengthQueuingStrategy.prototype,"size",{get:function(){if(!_r(this))throw mr("size");return pr},enumerable:!1,configurable:!0}),ByteLengthQueuingStrategy}();function mr(e){return new TypeError("ByteLengthQueuingStrategy.prototype."+e+" can only be used on a ByteLengthQueuingStrategy")}function _r(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")}Object.defineProperties(hr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(hr.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});var yr=function size(){return 1},vr=function(){function CountQueuingStrategy(e){M(e,1,"CountQueuingStrategy"),e=br(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}return Object.defineProperty(CountQueuingStrategy.prototype,"highWaterMark",{get:function(){if(!Sr(this))throw gr("highWaterMark");return this._countQueuingStrategyHighWaterMark},enumerable:!1,configurable:!0}),Object.defineProperty(CountQueuingStrategy.prototype,"size",{get:function(){if(!Sr(this))throw gr("size");return yr},enumerable:!1,configurable:!0}),CountQueuingStrategy}();function gr(e){return new TypeError("CountQueuingStrategy.prototype."+e+" can only be used on a CountQueuingStrategy")}function Sr(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")}function wr(e,t,r){return L(e,r),function(r){return S(e,t,[r])}}function Rr(e,t,r){return L(e,r),function(r){return g(e,t,[r])}}function Tr(e,t,r){return L(e,r),function(r,o){return S(e,t,[r,o])}}Object.defineProperties(vr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(vr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});var Pr=function(){function TransformStream(e,t,r){void 0===e&&(e={}),void 0===t&&(t={}),void 0===r&&(r={}),void 0===e&&(e=null);var o=Ye(t,"Second parameter"),n=Ye(r,"Third parameter"),i=function(e,t){F(e,t);var r=null==e?void 0:e.flush,o=null==e?void 0:e.readableType,n=null==e?void 0:e.start,i=null==e?void 0:e.transform,a=null==e?void 0:e.writableType;return{flush:void 0===r?void 0:wr(r,e,t+" has member 'flush' that"),readableType:o,start:void 0===n?void 0:Rr(n,e,t+" has member 'start' that"),transform:void 0===i?void 0:Tr(i,e,t+" has member 'transform' that"),writableType:a}}(e,"First parameter");if(void 0!==i.readableType)throw new RangeError("Invalid readableType specified");if(void 0!==i.writableType)throw new RangeError("Invalid writableType specified");var a,u=Me(n,0),l=Qe(n),s=Me(o,1),b=Qe(o);!function(e,t,r,o,n,i){function a(){return t}e._writable=function(e,t,r,o,n,i){void 0===n&&(n=1),void 0===i&&(i=function(){return 1});var a=Object.create(Xe.prototype);return Ke(a),_t(a,Object.create(mt.prototype),e,t,r,o,n,i),a}(a,(function(t){return function(e,t){var r=e._transformStreamController;if(e._backpressure){return _(e._backpressureChangePromise,(function(){var o=e._writable;if("erroring"===o._state)throw o._storedError;return Ar(r,t)}))}return Ar(r,t)}(e,t)}),(function(){return function(e){var t=e._readable,r=e._transformStreamController,o=r._flushAlgorithm();return Br(r),_(o,(function(){if("errored"===t._state)throw t._storedError;Ht(t._readableStreamController)}),(function(r){throw Cr(e,r),t._storedError}))}(e)}),(function(t){return function(e,t){return Cr(e,t),d(void 0)}(e,t)}),r,o),e._readable=ir(a,(function(){return function(e){return Or(e,!1),e._backpressureChangePromise}(e)}),(function(t){return Er(e,t),d(void 0)}),n,i),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Or(e,!0),e._transformStreamController=void 0}(this,c((function(e){a=e})),s,b,u,l),function(e,t){var r=Object.create(Wr.prototype),o=function(e){try{return kr(r,e),d(void 0)}catch(e){return f(e)}},n=function(){return d(void 0)};void 0!==t.transform&&(o=function(e){return t.transform(e,r)});void 0!==t.flush&&(n=function(){return t.flush(r)});!function(e,t,r,o){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=o}(e,r,o,n)}(this,i),void 0!==i.start?a(i.start(this._transformStreamController)):a(void 0)}return Object.defineProperty(TransformStream.prototype,"readable",{get:function(){if(!qr(this))throw Dr("readable");return this._readable},enumerable:!1,configurable:!0}),Object.defineProperty(TransformStream.prototype,"writable",{get:function(){if(!qr(this))throw Dr("writable");return this._writable},enumerable:!1,configurable:!0}),TransformStream}();function qr(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")}function Cr(e,t){Ut(e._readable._readableStreamController,t),Er(e,t)}function Er(e,t){Br(e._transformStreamController),St(e._writable._writableStreamController,t),e._backpressure&&Or(e,!1)}function Or(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=c((function(t){e._backpressureChangePromise_resolve=t})),e._backpressure=t}Object.defineProperties(Pr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Pr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});var Wr=function(){function TransformStreamDefaultController(){throw new TypeError("Illegal constructor")}return Object.defineProperty(TransformStreamDefaultController.prototype,"desiredSize",{get:function(){if(!jr(this))throw zr("desiredSize");return Gt(this._controlledTransformStream._readable._readableStreamController)},enumerable:!1,configurable:!0}),TransformStreamDefaultController.prototype.enqueue=function(e){if(void 0===e&&(e=void 0),!jr(this))throw zr("enqueue");kr(this,e)},TransformStreamDefaultController.prototype.error=function(e){if(void 0===e&&(e=void 0),!jr(this))throw zr("error");var t;t=e,Cr(this._controlledTransformStream,t)},TransformStreamDefaultController.prototype.terminate=function(){if(!jr(this))throw zr("terminate");!function(e){var t=e._controlledTransformStream;Ht(t._readable._readableStreamController);var r=new TypeError("TransformStream terminated");Er(t,r)}(this)},TransformStreamDefaultController}();function jr(e){return!!n(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")}function Br(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function kr(e,t){var r=e._controlledTransformStream,o=r._readable._readableStreamController;if(!Xt(o))throw new TypeError("Readable side is not in a state that permits enqueue");try{Vt(o,t)}catch(e){throw Er(r,e),r._readable._storedError}(function(e){return!xt(e)})(o)!==r._backpressure&&Or(r,!0)}function Ar(e,t){return _(e._transformAlgorithm(t),void 0,(function(t){throw Cr(e._controlledTransformStream,t),t}))}function zr(e){return new TypeError("TransformStreamDefaultController.prototype."+e+" can only be used on a TransformStreamDefaultController")}function Dr(e){return new TypeError("TransformStream.prototype."+e+" can only be used on a TransformStream")}Object.defineProperties(Wr.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"==typeof t.toStringTag&&Object.defineProperty(Wr.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});var Fr={ReadableStream:nr,ReadableStreamDefaultController:Mt,ReadableByteStreamController:pe,ReadableStreamBYOBRequest:be,ReadableStreamDefaultReader:$,ReadableStreamBYOBReader:Fe,WritableStream:Xe,WritableStreamDefaultController:mt,WritableStreamDefaultWriter:lt,ByteLengthQueuingStrategy:hr,CountQueuingStrategy:vr,TransformStream:Pr,TransformStreamDefaultController:Wr};if(void 0!==o)for(var Lr in Fr)Object.prototype.hasOwnProperty.call(Fr,Lr)&&Object.defineProperty(o,Lr,{value:Fr[Lr],writable:!0,configurable:!0});e.ByteLengthQueuingStrategy=hr,e.CountQueuingStrategy=vr,e.ReadableByteStreamController=pe,e.ReadableStream=nr,e.ReadableStreamBYOBReader=Fe,e.ReadableStreamBYOBRequest=be,e.ReadableStreamDefaultController=Mt,e.ReadableStreamDefaultReader=$,e.TransformStream=Pr,e.TransformStreamDefaultController=Wr,e.WritableStream=Xe,e.WritableStreamDefaultController=mt,e.WritableStreamDefaultWriter=lt,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=polyfill.min.js.map
